<!DOCTYPE html>
<html>
<head>
    <title>아트재고톡톡</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link rel="stylesheet" href="https://artpresso.github.io/license/style_i.css">
</head>
<body>

    <div id="loader">
        <div><strong>아트재고톡톡</strong></div>
        <div><span style='font-size:13px; color:#999;'>시스템 접속 중</span></div>
    </div>

    <iframe id="appFrame"></iframe>

    <script>
        // 주소창에서 '?id=' 값을 가져옴
        const urlParams = new URLSearchParams(window.location.search);
        const scriptId = urlParams.get('id');

        const iframe = document.getElementById('appFrame');
        const loader = document.getElementById('loader');

        if (scriptId) {
            // ID가 있으면 연결
            iframe.src = `https://script.google.com/macros/s/${scriptId}/exec`;

            // 로딩 완료 시 화면 전환
            iframe.onload = function() {
                loader.style.display = 'none';
                iframe.style.display = 'block';
            };
        } else {
            loader.innerHTML = `
                <div><strong style="color: #e53935;">잘못된 접근입니다</strong></div>
                <div style="margin-top: 5px;">
                    <span style="font-size: 13px; color: #666;">주소 뒤에 ID가 없습니다.</span>
                </div>
            `;
        }
    </script>
</body>
</html>
